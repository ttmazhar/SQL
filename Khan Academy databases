--Create fashion store database
CREATE TABLE store (id INTEGER PRIMARY KEY, item TEXT, quantity INTEGER, sold INTEGER, price INTEGER);

INSERT INTO store VALUES (1, "pants", 10, 7, 1);
INSERT INTO store VALUES (2, "shirts", 20, 19, 5);
INSERT INTO store VALUES (3, "skirts", 5, 7, 8);
INSERT INTO store VALUES (4, "shorts", 15, 10, 6);
INSERT INTO store VALUES (5, "hats", 25, 15, 9);
INSERT INTO store VALUES (6, "jackets", 19, 5, 28);


--Display the database oredered by price.
  SELECT * FROM store
  ORDER BY price asc
  ;

--Find out how many items are sold.
  SELECT SUM(sold) FROM store
  ;

--Select all the song titles.
  SELECT title FROM songs
  ;

--Add another SELECT that uses OR to show the titles of the songs that have an 'epic' mood or a release date after 1990.
  SELECT title FROM songs
  WHERE mood="epic" OR released > 1990
  ;

--Add another SELECT that uses AND to show the titles of songs that are 'epic', and released after 1990, and less than 4 minutes long.
Note that the duration column is measured in seconds.
  WHERE mood="epic"AND released > 1990 AND duration < 240
  ;

--Select the title of all the songs by the artist named 'Queen'.
  SELECT title FROM songs WHERE artist="Queen"
  ;

--Select the name of all of the artists from the 'Pop' genre.
  SELECT name from artists where genre='Pop'
  ;

--Select the title of all the songs from the 'Pop' artists.
  SELECT title FROM songs 
  WHERE artist IN (SELECT name FROM artists WHERE genre ='Pop')
  ;
 
--Select all the authors who have written more than 1 million words.
  SELECT author, SUM(words) AS total_words FROM books
  GROUP BY author
  HAVING total_words > 1000000
  ;
  
--Select all the authors that write more than an average of 150,000 words per book.
Your results table should include the 'author' and average words as an 'avg_words' column.
  SELECT author, AVG(words) AS avg_words FROM books
  GROUP BY author
  HAVING avg_words > 150000
  ;
    
--Select all of the rows, and display the name, number_grade, and percent_completed,
which you can compute by multiplying and rounding the fraction_completed column.
  SELECT name, number_grade, ROUND (fraction_completed*100) AS percent_completed FROM student_grades
  ;

--The goal is a table that shows how many students have earned which letter_grade.
  SELECT COUNT(*),
   CASE
   WHEN number_grade > 90 THEN 'A'
   WHEN number_grade > 80 THEN 'B'
   WHEN number_grade > 70 THEN 'C'
   ELSE 'F'
   END as 'letter_grade'
  FROM student_grades
  GROUP BY letter_grade
  ;

--Select everything from the table topmovies limiting 20.
  SELECT * FROM topmovies
  LIMIT 20
  ;

--Select Title and average 'Worldwide' row as 'avg_worldwide' which is grouped by Title and is more than 2000.
  SELECT Title, AVG(Worldwide) AS 'avg_worldwide' FROM topmovies
  GROUP BY Title
  HAVING avg_worldwide > 2000
  ;

--Select all the studios with MIN domestic number.
  SELECT Studio, MIN(Domestic) AS min_domestic
  FROM topmovies
  GROUP BY Studio
  ;
  
--Select the movie title that is in max in Rank.
  SELECT Title, MAX(Rank) AS max_rank
  FROM topmovies
  ;
  
--Select titles that have WB studio, ordered by their rank.
  SELECT Rank, Title, Studio FROM topmovies
  GROUP BY Title
  HAVING Studio='WB'
  ORDER BY Rank
  ;

--Select all ranks and titles and add a row 'movies_grades' with Overseas values.
'A' for more than 1500, 'B' for more than 1000, 'C' for more than 500 and rest of them 'D'.
  SELECT Rank, Title, Overseas
    CASE
      WHEN Overseas > 1500 THEN 'A'
      WHEN Overseas > 1000 THEN 'B'
      WHEN Overseas > 500 THEN 'C'
      ELSE 'D'
   END as 'movie_grade'
FROM topmovies
;

--Select titles showing that are in Fox Studiio and ranked in top 50.
  SELECT Rank, Title FROM topmovies
  WHERE Studio='Fox' AND Rank <50
  ;
  
--Select titles that are with WB studio or released after 2005, showing recent titles first.
  SELECT Rank, Title, Year FROM topmovies
  WHERE Studio='WB' OR Year > 2005
  ORDER BY Year DESC
  ;


--Insert one more row in persons and then one more row in hobbies that is related to the newly inserted person.
  INSERT INTO persons (name, age) VALUES ("Nancy", 30);
  
  INSERT INTO hobbies (person_id, name) VALUES (5, "walking");

--Select the 2 tables with a join so that you can see each person's name next to their hobby.
  SELECT p.name, h.name
  FROM persons AS p
  JOIN hobbies AS h
  ON p.id=h.person_id
  ;
  
--Add an additional query that shows only the name and hobbies of 'Bobby McBobbyFace', using JOIN combined with WHERE.
  select p.name,h.name
  from persons p
  join hobbies h
  on p.id=h.person_id
  WHERE p.name='Bobby McBobbyFace'
  ;

--Come up with a query that lists the name and email of every customer followed by the item and price of orders they've made.
  SELECT c.name, c.email, o.item, o.price
  FROM customers c
  LEFT OUTER JOIN orders o
  ON c.id=o.customer_id
  ;
    
 --Create another query that will result in one row per each customer, with their name, email, and total amount of money they've spent on orders.
 Sort the rows according to the total money spent, from the most spent to the least spent.
  SELECT c.name, c.email, sum(o.price) as spent
  FROM customers c
  LEFT OUTER JOIN orders o
  ON c.id=o.customer_id
  GROUP BY c.name
  ORDER BY spent desc
  ;
  
--Issue a SELECT that will show the title of each movie next to its sequel's title (or NULL if it doesn't have a sequel).
  SELECT movies.title, sequels.title
  FROM movies
  LEFT OUTER JOIN movies sequels
  ON movies.sequel_id=sequels.id
  ;
  
--Use a JOIN to display a table showing people's names with their hobbies.
  SELECT p.fullname, h.name
  FROM persons p
  JOIN hobbies h
  ON p.id=h.person_id
  ;
  
--Show the names of each pair of friends, based on the data in the friends table.
  SELECT a.fullname, b.fullname
  FROM friends
  JOIN persons a
  ON a.id=friends.person1_id
  JOIN persons b
  ON b.id=friends.person2_id;

